{"id": "06e37b8d-e81e-4064-852c-3a5e40e545be", "code": "# initial_program.py\n# This file is evolved by AlphaEvolve\n# ONLY update_rho (and helpers) may be modified\n\nimport numpy as np\n\n\ndef tau(k, c=0.2, p=1.5, K0=3):\n    \"\"\"\n    C1-safe diminishing step size.\n    Start updates even earlier for faster adaptation with slower decay.\n    \"\"\"\n    if k < K0:\n        return 0.0\n    return c / ((k - K0 + 1.0) ** p)\n\n\ndef update_rho(\n    rho,\n    k,\n    r_norm,\n    s_norm,\n    mu=2.0,\n    c=0.2,\n    p=2.0,\n    eps=1e-12,\n):\n    \"\"\"\n    Adaptive ADMM update with balanced adjustments.\n    Simpler trigger conditions for more responsive updates.\n    \"\"\"\n    t = tau(k, c=c, p=p)\n\n    # Simple trigger: respond to imbalances\n    if r_norm > mu * max(s_norm, eps):\n        return rho * (1.0 + t), t, \"mul\"\n    elif s_norm > mu * max(r_norm, eps):\n        return rho / (1.0 + t), t, \"div\"\n    else:\n        # When residuals are balanced, adjust based on their magnitude\n        avg_residual = (r_norm + s_norm) / 2.0\n        # Use thresholds and adjustment factor inspired by top performers\n        if avg_residual > 0.65:  # Moderate to large residuals\n            return rho * (1.0 + t/2.5), t, \"inc\"\n        elif avg_residual < 0.03:  # Very small residuals\n            return rho / (1.0 + t/2.5), t, \"dec\"\n        else:\n            return rho, t, \"keep\"\n", "language": "python", "parent_id": "8fa5d625-8a48-475c-8e23-ece5d35ac435", "generation": 4, "timestamp": 1770109909.3848221, "iteration_found": 0, "metrics": {"combined_score": 0.08288961966270761, "metrics": {"converged": true, "iters": 12, "combined_score": 0.08288961966270761}, "artifacts": {"status": "CONVERGED", "iterations": 12, "eval_time": "34.880s"}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Change 1: Replace 8 lines with 8 lines\nChange 2: Replace 15 lines with 15 lines", "parent_metrics": {"combined_score": 0.08285575071539425, "metrics": {"converged": true, "iters": 12, "combined_score": 0.08285575071539425}, "artifacts": {"status": "CONVERGED", "iterations": 12, "eval_time": "28.714s"}}, "island": 3, "migrant": true}, "prompts": null, "artifacts_json": null, "artifact_dir": null, "embedding": null}