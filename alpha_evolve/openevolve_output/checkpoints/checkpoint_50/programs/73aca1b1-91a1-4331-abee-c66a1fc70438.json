{"id": "73aca1b1-91a1-4331-abee-c66a1fc70438", "code": "# initial_program.py\n# This file is evolved by AlphaEvolve\n# ONLY update_rho (and helpers) may be modified\n\nimport numpy as np\n\n\ndef tau(k, c=0.2, p=2.0, K0=3):\n    \"\"\"\n    C1-safe diminishing step size.\n    Start updates earlier for faster adaptation.\n    \"\"\"\n    if k < K0:\n        return 0.0\n    return c / ((k - K0 + 1.0) ** p)\n\n\ndef update_rho(\n    rho,\n    k,\n    r_norm,\n    s_norm,\n    mu=2.0,\n    c=0.2,\n    p=2.0,\n    eps=1e-12,\n):\n    \"\"\"\n    Adaptive ADMM update with balanced adjustments.\n    Simpler trigger conditions for more responsive updates.\n    \"\"\"\n    t = tau(k, c=c, p=p)\n\n    # Simple trigger: respond to imbalances\n    if r_norm > mu * max(s_norm, eps):\n        return rho * (1.0 + t), t, \"mul\"\n    elif s_norm > mu * max(r_norm, eps):\n        return rho / (1.0 + t), t, \"div\"\n    else:\n        # When residuals are balanced, adjust based on their magnitude\n        avg_residual = (r_norm + s_norm) / 2.0\n        # Use thresholds that are between diverse programs for diversity\n        if avg_residual > 0.65:  # Between 0.6 and 0.7\n            return rho * (1.0 + t/2.8), t, \"inc\"\n        elif avg_residual < 0.035:  # Between 0.03 and 0.04\n            return rho / (1.0 + t/2.8), t, \"dec\"\n        else:\n            return rho, t, \"keep\"\n", "language": "python", "parent_id": "1f90e687-8a67-4b99-90c3-b474ce85dabb", "generation": 2, "timestamp": 1770109909.3851242, "iteration_found": 0, "metrics": {"combined_score": 0.08286856358873966, "metrics": {"converged": true, "iters": 12, "combined_score": 0.08286856358873966}, "artifacts": {"status": "CONVERGED", "iterations": 12, "eval_time": "41.881s"}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Change 1: Replace 8 lines with 8 lines\nChange 2: Replace 38 lines with 31 lines", "parent_metrics": {"combined_score": 0.07525245001302518, "metrics": {"converged": true, "iters": 13, "combined_score": 0.07525245001302518}, "artifacts": {"status": "CONVERGED", "iterations": 13, "eval_time": "32.521s"}}, "island": 3, "migrant": true}, "prompts": null, "artifacts_json": null, "artifact_dir": null, "embedding": null}