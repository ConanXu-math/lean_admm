{"id": "846b7016-b53c-4b5f-8f77-4c840e907fe0", "code": "# initial_program.py\n# This file is evolved by AlphaEvolve\n# Only update_rho (and helpers) should be modified\n\nimport numpy as np\n\n\ndef tau(k, c=1.0, p=1.2):\n    \"\"\"\n    Diminishing step size sequence.\n\n    Requirements:\n    - tau_k >= 0\n    - summable for p > 1\n    - depends only on k and fixed constants\n    \"\"\"\n    return c / ((k + 1.0) ** p)\n\n\ndef update_rho(\n    rho,\n    k,\n    r_norm,\n    s_norm,\n    mu=3.0,\n    c=1.0,\n    p=1.2,\n    eps=1e-12,\n):\n    \"\"\"\n    C1-safe adaptive ADMM penalty update rule.\n\n    Conservative by design with adaptive step scaling based on residual imbalance.\n    \"\"\"\n    # Summable step size (independent of residuals)\n    t = tau(k, c, p)\n\n    # Compute imbalance ratio for adaptive scaling\n    if r_norm > eps and s_norm > eps:\n        ratio = max(r_norm / s_norm, s_norm / r_norm)\n    else:\n        ratio = 1.0\n    \n    # Bounded linear scaling similar to top performers but with slight variation\n    # Use min(ratio/mu, 1.4) to prevent excessive updates\n    scale = min(ratio / mu, 1.4)\n    adjusted_t = t * (1.0 + 0.4 * scale)  # Increase t by up to 56% when ratio is large\n    \n    # Direction logic with fixed threshold\n    if r_norm > mu * max(s_norm, eps):\n        factor = 1.0 + adjusted_t\n        new_rho = rho * factor\n        mode = \"mul\"\n\n    elif s_norm > mu * max(r_norm, eps):\n        factor = 1.0 + adjusted_t\n        new_rho = rho / factor\n        mode = \"div\"\n\n    else:\n        new_rho = rho\n        mode = \"keep\"\n\n    # Auxiliary scalar: include information about adjustment\n    aux = adjusted_t\n\n    return new_rho, aux, mode\n", "language": "python", "parent_id": "e29051cf-d593-4144-b0c9-83f2567b7a3b", "generation": 4, "timestamp": 1770113071.69614, "iteration_found": 0, "metrics": {"combined_score": 0.08291186031768016, "metrics": {"converged": true, "iters": 12, "combined_score": 0.08291186031768016}, "artifacts": {"status": "CONVERGED", "iterations": 12, "eval_time": "23.591s"}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Change 1: Replace 6 lines with 4 lines\nChange 2: Replace 12 lines with 10 lines\nChange 3: Replace 5 lines with 5 lines", "parent_metrics": {"combined_score": 0.07656686011615371, "metrics": {"converged": true, "iters": 13, "combined_score": 0.07656686011615371}, "artifacts": {"status": "CONVERGED", "iterations": 13, "eval_time": "28.698s"}}, "island": 3, "migrant": true}, "prompts": null, "artifacts_json": null, "artifact_dir": null, "embedding": null}