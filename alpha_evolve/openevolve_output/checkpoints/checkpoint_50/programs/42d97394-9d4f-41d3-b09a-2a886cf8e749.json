{"id": "42d97394-9d4f-41d3-b09a-2a886cf8e749", "code": "# initial_program.py\n# This file is evolved by AlphaEvolve\n# ONLY update_rho (and helpers) may be modified\n\nimport numpy as np\n\n\ndef tau(k, c=0.2, p=1.8, K0=3):\n    \"\"\"\n    C1-safe diminishing step size.\n    Start updates even earlier for faster adaptation.\n    \"\"\"\n    if k < K0:\n        return 0.0\n    return c / ((k - K0 + 1.0) ** p)\n\n\ndef update_rho(\n    rho,\n    k,\n    r_norm,\n    s_norm,\n    mu=2.0,\n    c=0.2,\n    p=2.0,\n    eps=1e-12,\n):\n    \"\"\"\n    Adaptive ADMM update with balanced adjustments.\n    Simpler trigger conditions for more responsive updates.\n    \"\"\"\n    t = tau(k, c=c, p=p)\n\n    # Simple trigger: respond to imbalances\n    if r_norm > mu * max(s_norm, eps):\n        return rho * (1.0 + t), t, \"mul\"\n    elif s_norm > mu * max(r_norm, eps):\n        return rho / (1.0 + t), t, \"div\"\n    else:\n        # When residuals are balanced, adjust based on their magnitude\n        avg_residual = (r_norm + s_norm) / 2.0\n        # Use thresholds that balance responsiveness and stability\n        if avg_residual > 0.65:  # Moderate to large residuals\n            return rho * (1.0 + t/2.8), t, \"inc\"\n        elif avg_residual < 0.045:  # Very small residuals\n            return rho / (1.0 + t/2.8), t, \"dec\"\n        else:\n            return rho, t, \"keep\"\n", "language": "python", "parent_id": "4de2b2a7-ab47-4fca-a894-9eb35cbfc4b2", "generation": 3, "timestamp": 1770109909.385243, "iteration_found": 0, "metrics": {"combined_score": 0.08286856358873966, "metrics": {"converged": true, "iters": 12, "combined_score": 0.08286856358873966}, "artifacts": {"status": "CONVERGED", "iterations": 12, "eval_time": "29.719s"}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Change 1: Replace 5 lines with 5 lines\nChange 2: 'def tau(k, c=0.2, p=2.0, K0=3):' to 'def tau(k, c=0.2, p=1.8, K0=3):'", "parent_metrics": {"combined_score": 0.08280407275036661, "metrics": {"converged": true, "iters": 12, "combined_score": 0.08280407275036661}, "artifacts": {"status": "CONVERGED", "iterations": 12, "eval_time": "35.404s"}}, "island": 3, "migrant": true}, "prompts": null, "artifacts_json": null, "artifact_dir": null, "embedding": null}