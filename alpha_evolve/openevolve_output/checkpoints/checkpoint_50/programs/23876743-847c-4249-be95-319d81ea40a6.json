{"id": "23876743-847c-4249-be95-319d81ea40a6", "code": "# initial_program.py\n# This file is evolved by AlphaEvolve\n# Only update_rho (and helpers) should be modified\n\nimport numpy as np\n\n\ndef tau(k, c=1.0, p=1.2):\n    \"\"\"\n    Diminishing step size sequence.\n\n    Requirements:\n    - tau_k >= 0\n    - summable for p > 1\n    - depends only on k and fixed constants\n    \"\"\"\n    return c / ((k + 1.0) ** p)\n\n\ndef update_rho(\n    rho,\n    k,\n    r_norm,\n    s_norm,\n    mu=3.0,\n    c=1.0,\n    p=1.2,\n    eps=1e-12,\n):\n    \"\"\"\n    C1-safe adaptive ADMM penalty update rule with moderate adjustment.\n    \"\"\"\n    # Summable step size\n    t = tau(k, c, p)\n    \n    # Compute imbalance ratio\n    if r_norm > eps and s_norm > eps:\n        ratio = max(r_norm / s_norm, s_norm / r_norm)\n    else:\n        ratio = 1.0\n    \n    # Adjust step size based on ratio, but keep it bounded\n    # Use a moderate scaling: min(ratio / mu, 1.4) to prevent excessive updates\n    scale = min(ratio / mu, 1.4)\n    adjusted_t = t * (1.0 + 0.4 * scale)  # Increase t by up to 56% when ratio is large\n    \n    # Direction logic\n    if r_norm > mu * max(s_norm, eps):\n        new_rho = rho * (1.0 + adjusted_t)\n        mode = \"mul\"\n    elif s_norm > mu * max(r_norm, eps):\n        new_rho = rho / (1.0 + adjusted_t)\n        mode = \"div\"\n    else:\n        new_rho = rho\n        mode = \"keep\"\n    \n    # Auxiliary scalar includes adjustment information\n    aux = adjusted_t\n    \n    return new_rho, aux, mode\n", "language": "python", "parent_id": "c2f88fd2-6323-4a12-be60-25c3ee73b443", "generation": 5, "timestamp": 1770113071.696295, "iteration_found": 0, "metrics": {"combined_score": 0.08291186031768016, "metrics": {"converged": true, "iters": 12, "combined_score": 0.08291186031768016}, "artifacts": {"status": "CONVERGED", "iterations": 12, "eval_time": "30.208s"}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Change 1: Replace 4 lines with 4 lines", "parent_metrics": {"combined_score": 0.08282272821092926, "metrics": {"converged": true, "iters": 12, "combined_score": 0.08282272821092926}, "artifacts": {"status": "CONVERGED", "iterations": 12, "eval_time": "27.670s"}}, "island": 1, "migrant": true}, "prompts": null, "artifacts_json": null, "artifact_dir": null, "embedding": null}